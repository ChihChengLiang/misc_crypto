import pytest
from hashlib import blake2b
from main import littleEndianToInt, getPseudoRandom


def test_littleEndianToInt():
    assert littleEndianToInt(b"poseidon") == 7957689470423363440


def test_blake2b_version():
    h = blake2b(b'poseidon_constants', digest_size=32).hexdigest()
    assert h == 'e57ba154fb2c47811dc1a2369b27e25a44915b4e4ece4eb8ec74850cb78e01b1'


def test_getPseudoRandom():
    assert getPseudoRandom(b"poseidon", 5) == (
        15824101442726336678493729790213225602337266391839199937743631806357667769936,
        21242663800926259018279473475394539681984199997998092992785924410742632368937,
        7537673755943127760422551293899591957569458436859277585653724494712104093827,
        13103956771683026785204972701532832557470888040257734043695564144998080518407,
        14473492389881884561010535037929347039894105704213210537867280693408016123791
    )
